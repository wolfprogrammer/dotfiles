/*--------------------------------------------------------------
                main.c
  
PIC16F877A 4MHZ Clock

Caio Rodrigues Soares Silva

	Teste do LCD no modo 8 bits


	Dados D0-D7 PORTB
	Controle:
				RW no GND
				E em RA2
				RS em RA1


--------------------------------------------------------------*/


/* Processador de arquivo de cabeçalho */

#define clock4mhz
#define __16f877a

#include "pic/pic16f877a.h"
#include "commdefs.h"
#include "delay.h"
//#include "adc.h"

#define LCD_data  PORTB
#define LCD_tris  TRISB
#define LCD_E	RA1
#define LCD_RS	RA2
// O pino RW etá no GND ,vale sempre 0


//--------------Comandos do display---------------

#define _CLEAR_DISPLAY_		0x01
#define _CURSOR_HOME_		0x02
#define _INIT_MODE_			0x30 /* Function set 8 bit mode,1-line 5x7 dot*/

//Controle do cursor		00001dcb
#define	_CURSOR_ON_		  0b00001010 
#define _BLINK_CHAR_	  0b00001001
#define _DISPLAY_ON_	  0b00001100
//
//		Para configurar basta fazer 8+ _CURSOR_ON+_BLINK_CHAR_
//


typedef unsigned int config;


config at 0x2007 __CONFIG= 
_WDT_OFF &		// Sem Watch dog timer 
_PWRTE_ON & 	// Com Power-On Reset
_BODEN_OFF &	// Com
_CP_OFF & 	    // Sem proteção do código
_DEBUG_OFF & 	// Sem debugger
_HS_OSC & 		// Oscilador cristal 4 MHZ
_CPD_OFF & 		//
_LVP_OFF; 		// Sem LVP:Low Voltage Programmming




// Envia comando ao LCD
void lcd_cmd(u8 cmd){
	
	LCD_RS=0;
	LCD_data=cmd;
	LCD_E=1;
	delay_us(40);
	

}


void lcd_init(){

		delay_ms(20);


		lcd_cmd(_CLEAR_DISPLAY_);
		delay_ms(5);

		lcd_cmd(0x30);		//Inicia com interface 8 bits 1-linha 5x7 pontos

	//	lcd_cmd(_CURSOR_ON_ | _BLINK_CHAR_ | _DISPLAY_ON_ );
		lcd_cmd(0x08);  //Display OFF
		lcd_cmd(0x0F);	//Display on, blink , cursor on

		lcd_cmd(0x06);

}



/////////////////////////////////////////////////////////////////
//						void main()							   //
//															   //
/////////////////////////////////////////////////////////////////
void main(){

		CMCON=7;		  // Desabilita comparadores analógicos
		ADCON1=6;
		ADCON0=0;		  // Todas entradas analógicas desabilitadas
		INTCON=0;		  //Sem interrupção

		TRISB=0;
		TRISA=0;

		
		lcd_init();

		while(1){/*Loop Para sempre*/
            
		
	    

				}//End of While1



} //end of main

/*----------------------------------------------------------*/





/*------------------------------------------------------------------
 ---------------------  END OF FILE --------------------------------
 ------------------------------------------------------------------*/

/*--------------------------------------------------------------
                main.c
  
PIC16F877A 4MHZ Clock

Caio Rodrigues Soares Silva

--------------------------------------------------------------*/


/* Processador de arquivo de cabeçalho */

#define clock4mhz
#define __16f877a

#include "pic/pic16f877a.h"
#include "commdefs.h"
#include "delay.h"
//#include "adc.h"


typedef unsigned int config;


config at 0x2007 __CONFIG= 
_WDT_OFF &		// Sem Watch dog timer 
_PWRTE_ON & 	// Com Power-On Reset
_BODEN_OFF &	// Com
_CP_OFF & 	    // Sem proteção do código
_DEBUG_OFF & 	// Sem debugger
_HS_OSC & 		// Oscilador cristal 4 MHZ
_CPD_OFF & 		//
_LVP_OFF; 		// Sem LVP:Low Voltage Programmming

#define ALL_ANALOGS

/*********************************************************
 *  				COnfigurações do ADC
 *
 *
 *
 * ADCON0 REGISTER (ADDRESS 1Fh)
 
 * R/W-0 R/W-0  R/W-0 R/W-0 R/W-0   U-0 R   /W-0    R/W
 * ADCS1 ADCS0  CHS2  CHS1  CHS0    GO/DONE  —     ADON
 * bit 7 										   bit 0
 *
CHS2:CHS0: Analog Channel Select bits
000 	= Channel 0 (AN0)
001 	= Channel 1 (AN1)
010 	= Channel 2 (AN2)
011 	= Channel 3 (AN3)
100 	= Channel 4 (AN4)
101 	= Channel 5 (AN5)
110 	= Channel 6 (AN6)
111	    = Channel 7 (AN7)

 *
 *
 */




void main(){

		CMCON=7;		  // Desabilita comparadores analógicos
		ADCON0=6;		  // Todas entradas analógicas desabilitadas
		INTCON=0;		  //Sem interrupção


		//-----> Configuração inicial do ADC <---\\
	
		ADCON1=0;		 //Inicia os registros do ADC
		ADCON0=0;

	
		ADON=0; //Desliga Conversor analógico digital

		ADFM=1; // Justificado a direita, bits mais 
				//significativos de adresh sãi lidos como 0


		//---------------Seleção do clock----------------------------\\
		
		ADCON1=0; 
		ADCS1=0 ;
		ADCS0=1;	//  Fosc/8= 4/8 = 500 KHZ


		//----------Configuração da porta A/D -----------------------\\
		//  0000xxxx  0V-5V
		ADCON1=ADCON1 & 0b11110000 | 0b00000100;  	// 			AN7 AN6 AN5 AN4 AN3 AN2 AN1 AN0  
						  						 	//			D    D   D  D   A   D    A   A


		//-------- Seleção do canal 0
		// AN0/RA0
		ADCON0 = ADCON0 | 0b00000000;

		//------- Ativa ADC
		ADON=1;

		//------------------------------------------//
		//		FIM DA CONFIGURAÇÃO DO ADC			//
		//------------------------------------------//
		
		TRISB=0; //Configurado como saída
		PORTB=0;
		TRISD=0;
		PORTD=0;


		while(1){/*Loop Para sempre*/
            
				GO_DONE=1;	//Inicia conversão do canal0 AN0 pino RA0
				
				//Espera a conversão terminar(processo de polling)
				while(GO_DONE);

				PORTB=ADRESL;


		
	    

				}// End of while



} //end of main

/*----------------------------------------------------------*/





/*------------------------------------------------------------------
 ---------------------  END OF FILE --------------------------------
 ------------------------------------------------------------------*/

/*			main.c
 *
 *
 *
 **/

#define DEBUGV1  /* Debug versão 2 */

#define pic16f877a

#define clock4mhz 
#define lcd_default
#define DEBUG_all


#include "pic16f877a.h"  
#include "default.h"
#include "delay.h"
#include "lcd-8bit.h"
#include "uart.h"


/**
 *@file main.c
 *@brief Teste da interface serial UART entre o PIC e o terminal(PIC-KIT2)
 *
 *
 *@author Caio Rodrigues Soares Silva
 *
 *
 *@warning It's still under development.Unstable.
 *
 */



/*
 *    |--------------------------------------------+
 *    |           CONFIGURATION BITS               |
 *    |                                            |
 *    +--------------------------------------------+
 */


typedef unsigned int config;

config __at 0x2007 __CONFIG= 
_WDT_OFF &    // Sem Watch dog timer 
_PWRTE_ON &   // Com Power-On Reset
_BODEN_OFF &  // Com
_CP_OFF &       // Sem proteção do código
_DEBUG_OFF &  // Sem debugger
_HS_OSC &     // Oscilador cristal 4 MHZ
_CPD_OFF &    //
_LVP_OFF;     



/*
 *    |--------------------------------------------+
 *    |    VARIÁVEIS GLOBAIS                       |
 *    |                                            |
 *    +--------------------------------------------+
 */

#define BTN0  RA0
u8 flag1;

/*
 *    |--------------------------------------------+
 *    |    DECLARAÇÃO DAS ROTINAS                  |
 *    |                                            |
 *    +--------------------------------------------+
 */

void lcd_init();
void lcd_sendchar(u8 x);



/*
 *    |--------------------------------------------+
 *    |           MAIN                             |
 *    |                                            |
 *    +--------------------------------------------+
 */
void main(void){


    CMCON=7;		  // Desabilita comparadores analógicos
    ADCON0=6;		  // Todas entradas analógicas desabilitadas
    INTCON=0;		  //Sem interrupção



#ifdef DEBUG_all
    initUART(25,1);
    prints("DEBUG ativado");
    newline();
    prints("Modificado v3.58");
#endif

    lcd_init();
   
#if 1 
    lcd_sendchar('H');
    lcd_sendchar('e');
    lcd_sendchar('l');
    lcd_sendchar('l');
    lcd_sendchar('o');
    lcd_sendchar('1');
    lcd_sendchar(' ');
    lcd_sendchar('W');
    lcd_sendchar('o');
    lcd_sendchar('5');
    lcd_sendchar('5');
    lcd_sendchar('d');
    
    
    delay_s(10);
      prints("Passou 5 seg\n");
    lcd_cmd(0x01); // Apaga o ecrã
    delay_ms(50);
    lcd_cmd(0x02);  // Home
    delay_ms(50);
    lcd_cmd(0x80);  // Força endereço inicial da RAM
    lcd_print("Hola mundo!!");
      prints("Saiu da rotina222");

//    lcd_cmd(LCD_CLEAR);
//    lcd_print("Hello World!!");
#endif


    BTN0=0x00;
    TRISA0=1;

    flag1=LOW;

   	while(TRUE) {

        if(BTN0)  { prints("Apertou BTN");}

   




    }//Endwhile

		
}//Endmain


//////////////////////////////////////////////////////////////
//                                                          //
//            IMPLEMENTAÇÃO DAS ROTINAS                     //
//                                                          //
//////////////////////////////////////////////////////////////




///////////////////////////////////////////////////////////
//                      END OF FILE                      //
///////////////////////////////////////////////////////////


// Emula função rlocfind do matlab, basta clicar em um ponto do gráfico // para determinar suas coordenadas e determinar o ganho correspondente K
//
//
function [s,k] = rlocfind
    s=[1,%i]*locate(1)
    k=-1/real(horner(G,s))    
endfunction

// Obtem argumento de número real
function [theta]=arg(z)
    theta=atan(real(z),imag(z))*180/%pi
endfunction


// Retorna póolos de malha fechada para dado valor de K
// Argumentos , 
//    G: Função de transferência 
//    K: Ganho especificado
function [r]=cloopoles(G,K)
r=roots(G.den+K*G.num)
endfunction

//  Determina o valor de K, para um dado valor de s=s1
//  k=-1/G(s)
function [k]=evalk (G,s1)
    k=horner(-1/G,s1)
endfunction


//  Feedback unitário de um função de K*G(S)
//  
//  G: Função em malha aberta: Open-loop
//  K: Ganho de ajuste
//
function [T]=ufeedback(K,G)
  T=K*G/(1+K*G)  
endfunction


//  hlightk  highlight k  ou destacar k
//
// Determina os pólos em malha fechada correspondentes a um valor de K
//
function hlightk(G,k)
   p=cloopoles(G,k);
   X=real(p)
   Y=imag(p)

   plot(X,Y,"V");
   str="k="+string(k)
   xstring(X,Y,str,270)
   
endfunction

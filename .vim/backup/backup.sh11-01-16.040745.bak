#!/bin/bash
#  
#------------------------------------------------------------------------------
#
#		Script to perform backup of important files of select files and folders.
#
#-----------------------------------------------------------------
#	Backup configuration:
#
#		$backup_dest  		: Backup storage directory
#
#		$backup_list		: Text file with the path of files to backup
#
#
#  Created by Caio Rodrigues
#
#
#------------------------------------------------------------------------------


		##############################
		#							 #
		#	Backup configurations	 #
		##############################
		
backup_list=$HOME/bin/backup_list
backup_dest=/media/4A70-B330


backup_date=`date +%d-%m-%y`  # Date ex : 16-01-2002
backup_dir_name="backup-$backup_date"
backup_path="$backup_dest/$backup_dir_name"


echo ""
echo ""
echo "Os arquivos serão armazenados em:"
echo $backup_path
mkdir -p $backup_path


echo ""
echo ""
echo "Arquivo com a lista de backup"
echo "$backup_list"

echo ""
echo ""
echo "Lista de arquivos a fazer backup"
echo ""
#cat $backup_list

echo "Fazendo backup dos arquivos do sistem, ps.: Vai demorar um pouco"
echo "Por isso espere um pouco .... vá tomar um café... passear"
echo "É melhor fazer agora do que chorar depois"
sleep 3

echo ""
echo ""


for index in  `cat $backup_list | sed 's@//.*$@@g'`
do

		#	Remove .(dot) /(slash) characters from the name of file
		#
		fname=$(echo "$index-$backup_date"  | sed 's@\.@@g' | sed 's@/.*/@@g' | sed 's@/@@g')".tar.gz"
		echo "Fazendo backup do arquivo: $fname"
		echo "$index"
		echo ""

		
		fpath="$backup_path/$fname"
		sleep 2 
		tar -p -P -cvzf $fpath  $index

		echo ""
		echo "***********************************************"
		echo "Backup efetuado com sucesso $fname"
		echo "***********************************************"
		sleep 2

done
# end for
		echo ""
		echo ""
		echo "Para recuperar algum arquivo faça:"
		echo "$ tar -p -P -zxvf /path/arqvivo.tar.gz"
		echo


declare -i Size




# Create tar file with todays Month Day Year prepended for easy identification
#tar cvzf $Backup_Dest_Dir/$Backup_Name.tar.gz $Backup_Dirs #&> /dev/null



